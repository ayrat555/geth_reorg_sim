version: "3"
services:
  node-1:
    hostname: node-1
    environment:
      - account=0x8404AFE09D770271c935019F9f774CBA2bea291d
      - bootnodeId=6b42bf0d191ef43c51d2c968bf96e5ad8b38b819d49782b706389eb28886a3698a1a448df2e3067183a5ed397aa6713c374eac2206d139ce7ef88f027b73c3a8
      - bootnodeIp=172.25.0.103
    build:
      context: ./node
    container_name: node-1
    networks:
      chain:
        ipv4_address: 172.25.0.102

  node-2:
    hostname: node-2
    depends_on:
      - node-1
    environment:
      - account=0x2DEd039Be2c7e09Ea244F872003C8d50D9CF9F02
      - bootnodeId=4ee1d573617d2e7b74e73bbafb90c06506cf0bb20102fb03eeafa99e9e62d794056a69d4292382192632d9b0753418fb4cb00d340f74a640df04c4a01182c841
      - bootnodeIp=172.25.0.102
    build:
      context: ./node
    container_name: node-2
    networks:
      chain:
        ipv4_address: 172.25.0.103

  node-dev:
    hostname: node-dev
    depends_on:
      - node-2
    environment:
      - account=0xc8e2d04f0c3a825aae21d54d67cb65a63a154c12
      - bootnodeId=6b42bf0d191ef43c51d2c968bf96e5ad8b38b819d49782b706389eb28886a3698a1a448df2e3067183a5ed397aa6713c374eac2206d139ce7ef88f027b73c3a8
      - bootnodeIp=172.25.0.103
    build:
      context: ./node_dev
    container_name: node-dev
    ports:
      - 9000:8545
    healthcheck:
      test: wget http://localhost:9000
      interval: 2s
      timeout: 5s
      retries: 30
    networks:
      chain:
        ipv4_address: 172.25.0.104

networks:
  chain:
    driver: bridge
    ipam:
      config:
      - subnet: 172.25.0.0/24
